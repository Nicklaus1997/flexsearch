import Index from"./index.js";import default_resolver from"./resolve/default.js";import{apply_enrich}from"./document/search.js";import{ResolverOptions,IntermediateSearchResults}from"./type.js";import"./resolve/handler.js";import"./resolve/or.js";import"./resolve/and.js";import"./resolve/xor.js";import"./resolve/not.js";export default function Resolver(a){return this&&this.constructor===Resolver?a&&a.index?(a.resolve=!1,this.index=a.index,this.boostval=a.boost||0,this.result=a.index.search(a).result,this):void(this.index=null,this.result=a||[],this.boostval=0):new Resolver(a)}Resolver.prototype.limit=function(a){if(this.result.length){const b=[];let c=0;for(let d,e=0;e<this.result.length;e++)if(d=this.result[e],d.length+c<a)b[e]=d,c+=d.length;else{b[e]=d.slice(0,a-c),this.result=b;break}}return this},Resolver.prototype.offset=function(a){if(this.result.length){const b=[];let c=0;for(let d,e=0;e<this.result.length;e++)d=this.result[e],d.length+c<a?c+=d.length:(b[e]=d.slice(a-c),c=a);this.result=b}return this},Resolver.prototype.boost=function(a){return this.boostval+=a,this},Resolver.prototype.resolve=function(a,b,c){const d=this.result,e=this.index;return this.index=null,this.result=null,d.length?("object"==typeof a&&(c=a.enrich,b=a.offset,a=a.limit),default_resolver.call(e,d,a||100,b,c)):d};